#!/bin/sh
./gradlew spotlessApply build

echo '🔍 Running pre-commit checks...'
./gradlew spotlessApply  # 코드 스타일 자동 수정
./gradlew clean build -x test --scan

if [ $? -ne 0 ]; then
  echo "❌ Pre-commit checks failed. Fix the errors before committing."
  exit 1  # 커밋 차단
fi

echo "🔍 Checkstyle 검사 실행 중..."
./gradlew checkstyleMain
if [ $? -ne 0 ]; then
  echo "❌ Checkstyle 규칙 위반! 커밋이 중단됩니다."
  exit 1
fi

echo "✅ 모든 검사 통과! 커밋을 진행할 수 있습니다."
